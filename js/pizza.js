function google_geocode(){var a=new google.maps.Geocoder,b=document.getElementById("address").value;a.geocode({address:b},function(a,b){b==google.maps.GeocoderStatus.OK?(document.getElementById("results").innerHTML="",$("#load").show(),google_map(a[0].geometry.location.lat(),a[0].geometry.location.lng()),google_places(a[0].geometry.location.lat(),a[0].geometry.location.lng())):alert("Geocode was not successful for the following reason: "+b)})}function geo_location(){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(a){var b=a.coords.latitude,c=a.coords.longitude;google_map(b,c),google_places(b,c)}):alert("not supported")}function google_map(a,b){var c=new google.maps.LatLng(a,b),d={zoom:13,center:c,mapTypeId:google.maps.MapTypeId.ROADMAP};map=new google.maps.Map(document.getElementById("map"),d)}function google_places(a,b){$.ajax({type:"POST",url:"places.php",data:{lat:a,lon:b},dataType:"json",success:function(a){window.data=a;for(var b=0;b<a.length;b++){var c=new google.maps.LatLng(a[b].lati,a[b].long);if(a[b].rate)var d=a[b].rate+"/5";else var d="No Rating";document.getElementById("results").innerHTML+="<strong>"+a[b].name+'</strong> &mdash; <span style="color:#0000ff;">'+d+"</span><br />"+a[b].addr+'<br /><a href="tel:1'+a[b].phon.replace(/[\(\)\s+\.-]+/g,"")+'">'+a[b].phon+'</a> | <a href="#'+b+'">Reviews</a><div id="reviews-'+b+'"></div><br />',create_markers(c,a[b].name)}$("#load").hide()}})}function create_markers(a,b){new google.maps.Marker({position:a,map:map,title:b})}$(window).bind("hashchange",function(){$(".current").each(function(){$(this).html()&&($(this).html(""),$(this).removeClass("current"))});for(var b=window.location.hash.split("#"),c=0;c<data[b[1]].revi.length;c++)data[b[1]].revi[c].text&&(0==c?(document.getElementById("reviews-"+b[1]).innerHTML+=data[b[1]].revi[c].text,document.getElementById("reviews-"+b[1]).className="current"):(document.getElementById("reviews-"+b[1]).innerHTML+="<hr />"+data[b[1]].revi[c].text,document.getElementById("reviews-"+b[1]).className="current"))}),$(document).ready(function(){$("input[type='text']").click(function(){"search by city or address"==$(this).val()&&$(this).val("")}),$("input[type='text']").blur(function(){$(this).val()||$(this).val("search by city or address")})});